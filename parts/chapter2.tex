\chapter{Исследование}
\label{chapter2}

В данной главе рассматривается теоритические аспекты разработки фремворка. Проводится исследование существующих систем, описываются требования к разрабатываемой системе.

\section{JUnit}

Рассмотрим более подробно тестовый фреймворк JUnit. Данный фреймворк впервые показал, как надо устраивать процесс тестирования (на самом деле, основные идеи были сформированы Кент Беком при разработке SUnit, но именно в лице JUnit эти идеи получили широкое распространение):

\begin{itemize}
\item тесты представляют из себя набор проверок утверждений;
\item тесты могут быть сгруппированы в суиты, для совместного запуска;
\item суиты объеденяются в тест ран.
\end{itemize}

Для семейства xUnit существует стандартный отчет surefire. В приложении [номер] можно посмотреть на разные виды surefire-отчета. Ниже можно посмотреть пример простейщего JUnit теста.

\begin{lstlisting}
public class SampleTest {

    @Test
    public void sampleTest() throws Exception {
        assertThat(4, is(2 + 2));
    }
}
\end{lstlisting}

Основным недостатком xUnit является атомарность теста, невозможность отобразить тестовый сценарий. Основаный на JUnit тестовый фремворк Thucydides решает эту проблему путем разбиения тестов на шаги.

\section{Thucydides}
Thucydides это фремворк для написание тестов на веб-интерфейс с использованием webDriver, написанный Джоном Смартом (John Ferguson Smart). Джон Смарт --- специалист в BDD, в оптимизации жизненного цикла процесса разработки. Хорошо известеный спикер множества интернациональных конференций, автор множества статей.

В свое время данный фреймворк произвел революцию. Прежде всего, фремворк предлагал структуру для тестов на веб-интерфейс, концепцию разбиения тестов на шаги и возможность сохранять скриншоты каждого шага. Шагом теста являлся любой метод, проаннотированный аннотацией @Step.
Фремворк парсил структуру данных методов и отображал информацию о них в отчете. Мало того, это помогало сильно сократить код тестов --- шаги выносились в отдельные библиотеки и переиспользовались в множестве проектов.

Отчет, который строил Thucydides для тестов, могли посмотреть другие люди, и понять, что происходит в тесте. В Яндексе это позволило разделить тестировщиков на "автоматизаторов" и ответственных за релиз. Первые писали тесты, а вторые эти тесты запускали, просматривали результаты и, в случае необходимости, дополнительно проводили ручное тестирование продукта. Это позволило сильно увеличить качество тестирования за счет появления дополнительного уровня качества тестов.

Также важной фозможностью Thucydides являлось сохранение скриншотов. В тестах на веб-интерфейс очень важно иметь возможно увидеть, в чем проблема. Однако, не всегда хватает возможности сохранения только скриншотов. Хотелось бы уметь приклеплять к отчету и другие типы данных, например, логи.

Однако, есть в данном фреймворке и недостатки. Прежде всего, предложеная структура была слишком жесткой. С использованием Thucydides можно писать тесты на веб-интерфейс, но большая часть функциональных тестов тестирует не его, а, например, API. 

Еще одним важным недостатком было ограничение в технологиях: только JUnit, только Maven. Наверное, в любой большой компании тесты пишутся на разных языках программирования, в зависимости от специфики поставленной задачи. 

Кроме того, Thucydides пытался все написать сам, со временем превращаясь в большой проект с множеством проблем.

\subsection{Итого} 

Thucydides имеет следующие плюсы: 
\begin{itemize}
\item задается единая структура тестов;
\item разбиение тестов на шаги, отображение сценариев тестов;
\item сохранение скриншотов;
\item хороший отчет, с возможностью группировки тестов по требованиям.
\end{itemize}

Но минусов тоже много:
\begin{itemize}
\item слишком много ограничений, заданных структурой тестов;
\item слишком много ограничений на структуру шагов;
\item невозможность использовать другие типы аттачментов;
\item большое количество проблем и ошибок;
\item отчет понятен только тестировщикам.
\end{itemize}

Вывод: отличный фремворк, если речь идет только о простом тестировании веб-интерфейсов с использованием JUnit и Maven. В иных случаях не подходит.

\section{Уточненные требования к работе}

Основываясь на анализе существующих решений, были выработаны уточненные требования к фремворку Allure:

\begin{itemize}
\item умение оперировать как в терминах xUnit, так и в терминах BDD;
\item отображение сценария теста, разбиение теста на шаги;
\item возможность приклеплять к результатам теста произвольные данные;
\item независимость от стека используемых технологий;
\item простой и понятный отчет, который смогут смотреть не только разработчики тестов.
\end{itemize}